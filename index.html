<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Manager MVP</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-light">

    <!-- Navbar with Save/Load Actions -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top shadow-sm">
        <div class="container">
            <span class="navbar-brand mb-0 h1 fw-bold">ðŸ’° LoanManager MVP</span>
            
            <div class="d-flex align-items-center gap-2">
                <!-- Hidden input for file upload -->
                <input type="file" id="fileInput" accept=".txt,.json" style="display: none;" onchange="loadFromFile(this)">
                
                <button class="btn btn-outline-light btn-sm" onclick="document.getElementById('fileInput').click()">
                    ðŸ“‚ Load Backup
                </button>
                <button class="btn btn-light btn-sm fw-bold" onclick="downloadData()">
                    ðŸ’¾ Save Data
                </button>
                <button class="btn btn-danger btn-sm" onclick="clearData()">
                    âš  Reset
                </button>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        
        <!-- Dashboard Summary Cards -->
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card text-white bg-success mb-3 shadow-sm">
                    <div class="card-body">
                        <h6 class="card-title text-uppercase opacity-75">Total Lent (Principal)</h6>
                        <h2 id="totalLent">$0.00</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-white bg-warning mb-3 shadow-sm">
                    <div class="card-body">
                        <h6 class="card-title text-uppercase opacity-75">Outstanding Balance</h6>
                        <h2 id="totalOutstanding">$0.00</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-white bg-info mb-3 shadow-sm">
                    <div class="card-body">
                        <h6 class="card-title text-uppercase opacity-75">Active Clients</h6>
                        <h2 id="totalClients">0</h2>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <button class="nav-link active fw-bold" id="clients-tab" data-bs-toggle="tab" data-bs-target="#clients" type="button">ðŸ‘¥ Clients</button>
            </li>
            <li class="nav-item">
                <button class="nav-link fw-bold" id="loans-tab" data-bs-toggle="tab" data-bs-target="#loans" type="button">ðŸ“„ Loans</button>
            </li>
        </ul>

        <div class="tab-content bg-white p-4 border border-top-0 rounded-bottom shadow-sm">
            
            <!-- Clients Section -->
            <div class="tab-pane fade show active" id="clients">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4 class="mb-0">Client List</h4>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addClientModal">+ Add Client</button>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Address</th>
                            </tr>
                        </thead>
                        <tbody id="clientTableBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Loans Section -->
            <div class="tab-pane fade" id="loans">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4 class="mb-0">Loan Portfolio</h4>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newLoanModal" onclick="loadClientSelect()">+ New Loan</button>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>Client</th>
                                <th>Total Due</th>
                                <th>Balance</th>
                                <th>Due Date</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="loanTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL 1: Add Client -->
    <div class="modal fade" id="addClientModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Client</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="clientForm">
                        <div class="mb-3">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="clientName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="clientPhone" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Address/ID</label>
                            <input type="text" class="form-control" id="clientAddress">
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Save Client</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL 2: New Loan -->
    <div class="modal fade" id="newLoanModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Originate Loan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loanForm">
                        <div class="mb-3">
                            <label class="form-label">Select Client</label>
                            <select class="form-select" id="loanClientSelect" required></select>
                        </div>
                        <div class="row g-2">
                            <div class="col-6 mb-3">
                                <label class="form-label">Principal ($)</label>
                                <input type="number" class="form-control" id="loanAmount" required>
                            </div>
                            <div class="col-6 mb-3">
                                <label class="form-label">Interest (%)</label>
                                <input type="number" class="form-control" id="loanRate" value="10" required>
                            </div>
                        </div>
                        <div class="row g-2">
                            <div class="col-6 mb-3">
                                <label class="form-label">Term (Months)</label>
                                <input type="number" class="form-control" id="loanTerm" value="1" required>
                            </div>
                            <div class="col-6 mb-3">
                                <label class="form-label">Start Date</label>
                                <input type="date" class="form-control" id="loanDate" required>
                            </div>
                        </div>
                        <div class="alert alert-secondary p-2 small">
                            <strong>Note:</strong> Interest is calculated flat upfront.
                        </div>
                        <button type="submit" class="btn btn-success w-100">Issue Loan</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL 3: Repayment -->
    <div class="modal fade" id="repaymentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Record Repayment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        Current Outstanding: <strong id="payCurrentBalance">$0.00</strong>
                    </div>
                    <input type="hidden" id="payLoanId">
                    <div class="mb-3">
                        <label class="form-label">Amount Received ($)</label>
                        <input type="number" class="form-control form-control-lg" id="payAmount" required placeholder="0.00">
                    </div>
                    <button onclick="processRepayment()" class="btn btn-primary w-100 btn-lg">Confirm Payment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
